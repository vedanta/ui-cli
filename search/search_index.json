{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to UI-CLI are documented here.</p>"},{"location":"changelog/#030-december-3-2024","title":"[0.3.0] - December 3, 2024","text":""},{"location":"changelog/#highlights","title":"Highlights","text":"<p>\ud83e\udd16 Claude Desktop Integration - Manage your UniFi network using natural language!</p> <p>\u26a1 Quick Timeout &amp; Spinners - Better UX for local commands with progress indicators!</p>"},{"location":"changelog/#added","title":"Added","text":"<p>MCP Server v2 (Tools Layer Architecture)</p> <ul> <li>16 AI-optimized tools for Claude Desktop integration</li> <li>Natural language network management</li> <li><code>./ui mcp install</code> - One-command setup</li> <li><code>./ui mcp check</code> - Verify installation</li> <li><code>./ui mcp show</code> - View configuration</li> </ul> <p>Available Tools</p> Category Tools Status &amp; Health <code>network_status</code>, <code>network_health</code>, <code>internet_speed</code>, <code>run_speedtest</code>, <code>isp_performance</code> Counts &amp; Lists <code>client_count</code>, <code>device_list</code>, <code>network_list</code> Lookups <code>find_client</code>, <code>find_device</code>, <code>client_status</code> Actions <code>block_client</code>, <code>unblock_client</code>, <code>kick_client</code>, <code>restart_device</code>, <code>create_voucher</code>"},{"location":"changelog/#architecture","title":"Architecture","text":"<ul> <li>Subprocess-based tools layer for consistent behavior</li> <li>CLI remains single source of truth</li> <li>JSON output for all action commands</li> </ul> <p>Quick Timeout &amp; Spinners</p> <ul> <li><code>--quick</code> / <code>-q</code> option for 5-second timeout on connectivity checks</li> <li><code>--timeout</code> / <code>-t</code> option for custom timeout values</li> <li>Spinners on all local commands for better UX</li> <li>Default timeout reduced from 30s to 15s</li> <li><code>UNIFI_NO_SPINNER</code> env var for CI/CD environments</li> <li>Auto-disable spinners when <code>CI=true</code> or <code>NO_COLOR</code> is set</li> </ul>"},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>Claude Desktop integration guide</li> <li>MCP architecture documentation</li> <li>Updated README with timeout options and CI/CD usage</li> </ul>"},{"location":"changelog/#020-december-1-2024","title":"[0.2.0] - December 1, 2024","text":""},{"location":"changelog/#highlights_1","title":"Highlights","text":"<p>\ud83e\udd8d Local Controller API - Direct connection to UDM, Cloud Key, and self-hosted controllers!</p>"},{"location":"changelog/#added_1","title":"Added","text":""},{"location":"changelog/#local-controller-commands-ui-lo","title":"Local Controller Commands (<code>./ui lo</code>)","text":"<p>Health &amp; Monitoring</p> <ul> <li><code>./ui lo health</code> - Site health summary</li> <li><code>./ui lo events list</code> - View recent events</li> </ul> <p>Client Management</p> <ul> <li><code>./ui lo clients list</code> - List connected clients with filters</li> <li><code>./ui lo clients all</code> - All clients including offline</li> <li><code>./ui lo clients get</code> - Client details by name or MAC</li> <li><code>./ui lo clients status</code> - Comprehensive client status</li> <li><code>./ui lo clients block/unblock</code> - Block or unblock clients</li> <li><code>./ui lo clients kick</code> - Disconnect clients</li> <li><code>./ui lo clients count</code> - Count by type/network/vendor/AP</li> <li><code>./ui lo clients duplicates</code> - Find duplicate names</li> </ul> <p>Device Management</p> <ul> <li><code>./ui lo devices list</code> - List network devices</li> <li><code>./ui lo devices get</code> - Device details</li> <li><code>./ui lo devices restart</code> - Restart a device</li> <li><code>./ui lo devices upgrade</code> - Upgrade firmware</li> <li><code>./ui lo devices locate</code> - Toggle locate LED</li> <li><code>./ui lo devices adopt</code> - Adopt new device</li> </ul> <p>Network Configuration</p> <ul> <li><code>./ui lo networks list</code> - List networks/VLANs</li> <li><code>./ui lo config show</code> - Export running config (table/JSON/YAML)</li> </ul> <p>Security &amp; Firewall</p> <ul> <li><code>./ui lo firewall list</code> - Firewall rules</li> <li><code>./ui lo firewall groups</code> - Address/port groups</li> <li><code>./ui lo portfwd list</code> - Port forwarding rules</li> </ul> <p>Guest Management</p> <ul> <li><code>./ui lo vouchers list</code> - List vouchers</li> <li><code>./ui lo vouchers create</code> - Create vouchers</li> <li><code>./ui lo vouchers delete</code> - Delete vouchers</li> </ul> <p>DPI &amp; Statistics</p> <ul> <li><code>./ui lo dpi stats</code> - Site DPI statistics</li> <li><code>./ui lo dpi client</code> - Per-client DPI</li> <li><code>./ui lo stats daily</code> - Daily traffic stats</li> <li><code>./ui lo stats hourly</code> - Hourly traffic stats</li> </ul> <p>Other</p> <ul> <li><code>./ui speedtest</code> - Run speedtest via controller</li> <li><code>./ui status</code> - Enhanced with local controller info</li> </ul>"},{"location":"changelog/#testing","title":"Testing","text":"<ul> <li>87 tests (71 unit, 16 integration)</li> <li>pytest-asyncio for async testing</li> </ul>"},{"location":"changelog/#documentation_1","title":"Documentation","text":"<ul> <li>Complete user guide</li> <li>Command reference</li> <li>Examples and troubleshooting</li> </ul>"},{"location":"changelog/#010-november-29-2024","title":"[0.1.0] - November 29, 2024","text":""},{"location":"changelog/#initial-release","title":"Initial Release","text":"<p>\ud83d\ude80 Site Manager API - Cloud-based multi-site management!</p>"},{"location":"changelog/#added_2","title":"Added","text":"<p>Authentication</p> <ul> <li>API key authentication via <code>UNIFI_API_KEY</code></li> <li><code>./ui status</code> - Connection check</li> </ul> <p>Hosts</p> <ul> <li><code>./ui hosts list</code> - List all controllers</li> <li><code>./ui hosts get</code> - Controller details</li> </ul> <p>Sites</p> <ul> <li><code>./ui sites list</code> - List all sites</li> </ul> <p>Devices</p> <ul> <li><code>./ui devices list</code> - List all devices</li> <li><code>./ui devices count</code> - Count by model/status/host</li> </ul> <p>ISP Metrics</p> <ul> <li><code>./ui isp metrics</code> - ISP performance with intervals</li> </ul> <p>SD-WAN</p> <ul> <li><code>./ui sdwan list</code> - List configurations</li> <li><code>./ui sdwan get</code> - Configuration details</li> <li><code>./ui sdwan status</code> - Deployment status</li> </ul> <p>Output Formats</p> <ul> <li>Table (default)</li> <li>JSON</li> <li>CSV</li> </ul>"},{"location":"changelog/#infrastructure","title":"Infrastructure","text":"<ul> <li>Typer CLI framework</li> <li>Rich terminal formatting</li> <li>httpx async HTTP client</li> <li>pydantic-settings configuration</li> </ul>"},{"location":"configuration/","title":"Configuration","text":"<p>UI-CLI uses environment variables for configuration. Create a <code>.env</code> file in the project root.</p>"},{"location":"configuration/#quick-setup","title":"Quick Setup","text":"<pre><code>cp .env.example .env\n# Edit .env with your credentials\n</code></pre>"},{"location":"configuration/#cloud-api-configuration","title":"Cloud API Configuration","text":"<p>For commands that use the UniFi Site Manager API (<code>api.ui.com</code>).</p> <pre><code># Required: Your API key\nUNIFI_API_KEY=your-api-key-here\n\n# Optional: API base URL (default: https://api.ui.com/v1)\nUNIFI_API_URL=https://api.ui.com/v1\n\n# Optional: Request timeout in seconds (default: 30)\nUNIFI_TIMEOUT=30\n</code></pre>"},{"location":"configuration/#getting-your-api-key","title":"Getting Your API Key","text":"<ol> <li>Go to unifi.ui.com</li> <li>Navigate to Settings \u2192 API</li> <li>Click Create API Key</li> <li>Copy the key immediately (it's only shown once!)</li> </ol> <p>API Key Security</p> <p>Never commit your <code>.env</code> file to version control. It's already in <code>.gitignore</code>.</p>"},{"location":"configuration/#local-controller-configuration","title":"Local Controller Configuration","text":"<p>For commands that connect directly to your UniFi Controller.</p> <pre><code># Required: Controller URL\nUNIFI_CONTROLLER_URL=https://192.168.1.1\n\n# Required: Credentials\nUNIFI_CONTROLLER_USERNAME=admin\nUNIFI_CONTROLLER_PASSWORD=yourpassword\n\n# Optional: Site name (default: \"default\")\nUNIFI_CONTROLLER_SITE=default\n\n# Optional: SSL verification (default: false)\nUNIFI_CONTROLLER_VERIFY_SSL=false\n</code></pre>"},{"location":"configuration/#controller-types","title":"Controller Types","text":"<p>UI-CLI automatically detects your controller type:</p> Controller API Path UDM / UDM Pro / UDM SE <code>/proxy/network/api/s/{site}/</code> Cloud Key / Self-hosted <code>/api/s/{site}/</code>"},{"location":"configuration/#ssl-certificates","title":"SSL Certificates","text":"<p>Most UniFi controllers use self-signed certificates. Set <code>UNIFI_CONTROLLER_VERIFY_SSL=false</code> to skip verification.</p> <p>Self-signed Certificates</p> <p>If you've installed a valid SSL certificate on your controller, you can set <code>UNIFI_CONTROLLER_VERIFY_SSL=true</code>.</p>"},{"location":"configuration/#full-example","title":"Full Example","text":"<pre><code># ===========================================\n# Cloud API (api.ui.com)\n# ===========================================\nUNIFI_API_KEY=your-api-key-here\nUNIFI_API_URL=https://api.ui.com/v1\nUNIFI_TIMEOUT=30\n\n# ===========================================\n# Local Controller\n# ===========================================\nUNIFI_CONTROLLER_URL=https://192.168.1.1\nUNIFI_CONTROLLER_USERNAME=admin\nUNIFI_CONTROLLER_PASSWORD=yourpassword\nUNIFI_CONTROLLER_SITE=default\nUNIFI_CONTROLLER_VERIFY_SSL=false\n</code></pre>"},{"location":"configuration/#data-storage","title":"Data Storage","text":"<p>UI-CLI stores local data in <code>~/.config/ui-cli/</code>:</p> File Purpose <code>session.json</code> Cached controller login session <code>groups.json</code> Client groups definitions"},{"location":"configuration/#session-management","title":"Session Management","text":"<p>Local controller sessions are cached to avoid repeated logins:</p> <ul> <li>Auto-refreshes on expiry</li> <li>Delete to force re-login</li> </ul> <pre><code># Force new session\nrm ~/.config/ui-cli/session.json\n./ui lo health\n</code></pre>"},{"location":"configuration/#groups-storage","title":"Groups Storage","text":"<p>Client groups are stored locally and don't require a network connection to manage:</p> <pre><code># View groups file location\nls ~/.config/ui-cli/groups.json\n\n# Backup groups\ncp ~/.config/ui-cli/groups.json ~/groups-backup.json\n\n# Or use the export command\n./ui groups export -o ~/groups-backup.json\n</code></pre>"},{"location":"configuration/#multiple-sites","title":"Multiple Sites","text":"<p>To switch between sites on the same controller:</p> <pre><code># Edit .env\nUNIFI_CONTROLLER_SITE=office\n\n# Or use a different .env file\ncp .env .env.office\n# Edit .env.office with different site\n</code></pre>"},{"location":"configuration/#verify-configuration","title":"Verify Configuration","text":"<pre><code># Check Cloud API\n./ui status\n\n# Check Local Controller\n./ui lo health\n</code></pre>"},{"location":"examples/","title":"Examples","text":"<p>Real-world usage examples and scripts for UI-CLI.</p>"},{"location":"examples/#scripting-with-json","title":"Scripting with JSON","text":""},{"location":"examples/#count-offline-devices","title":"Count Offline Devices","text":"<pre><code>#!/bin/bash\nOFFLINE=$(./ui devices list -o json | jq '[.[] | select(.status == \"offline\")] | length')\nif [ \"$OFFLINE\" -gt 0 ]; then\n    echo \"\u26a0\ufe0f  $OFFLINE devices offline!\"\n    ./ui devices list -o json | jq -r '.[] | select(.status == \"offline\") | .name'\nfi\n</code></pre>"},{"location":"examples/#find-high-traffic-clients","title":"Find High-Traffic Clients","text":"<pre><code># Clients with &gt; 10GB downloaded\n./ui lo clients list -o json | jq -r '.[] | select(.rx_bytes &gt; 10737418240) | \"\\(.name): \\(.rx_bytes / 1073741824 | floor)GB\"'\n</code></pre>"},{"location":"examples/#list-all-iphones","title":"List All iPhones","text":"<pre><code>./ui lo clients list -o json | jq '.[] | select(.name | test(\"iPhone\"; \"i\"))'\n</code></pre>"},{"location":"examples/#export-client-ips","title":"Export Client IPs","text":"<pre><code>./ui lo clients list -o json | jq -r '.[].ip' &gt; client-ips.txt\n</code></pre>"},{"location":"examples/#automation","title":"Automation","text":""},{"location":"examples/#daily-config-backup","title":"Daily Config Backup","text":"<pre><code>#!/bin/bash\n# backup-config.sh\nBACKUP_DIR=\"$HOME/unifi-backups\"\nDATE=$(date +%Y%m%d)\n\nmkdir -p \"$BACKUP_DIR\"\n./ui lo config show -o yaml &gt; \"$BACKUP_DIR/config-$DATE.yaml\"\necho \"Config backed up to $BACKUP_DIR/config-$DATE.yaml\"\n</code></pre> <p>Add to crontab:</p> <pre><code># Daily at 2am\n0 2 * * * /path/to/backup-config.sh\n</code></pre>"},{"location":"examples/#monitor-isp-latency","title":"Monitor ISP Latency","text":"<pre><code>#!/bin/bash\n# Check if latency exceeds threshold\nTHRESHOLD=50  # ms\n\nLATENCY=$(./ui isp metrics -i 5m -o json | jq -r '.[-1].latency_avg // 0')\nif (( $(echo \"$LATENCY &gt; $THRESHOLD\" | bc -l) )); then\n    echo \"High latency detected: ${LATENCY}ms\"\n    # Send notification, etc.\nfi\n</code></pre>"},{"location":"examples/#block-unknown-devices","title":"Block Unknown Devices","text":"<pre><code>#!/bin/bash\n# Block clients not in allowed list\nALLOWED=\"allowed-macs.txt\"\n\n./ui lo clients list -o json | jq -r '.[].mac' | while read mac; do\n    if ! grep -qi \"$mac\" \"$ALLOWED\"; then\n        echo \"Blocking unknown device: $mac\"\n        ./ui lo clients block \"$mac\" -y\n    fi\ndone\n</code></pre>"},{"location":"examples/#guest-network-management","title":"Guest Network Management","text":""},{"location":"examples/#create-event-vouchers","title":"Create Event Vouchers","text":"<pre><code># Create 50 vouchers for a 4-hour event with 1GB limit\n./ui lo vouchers create -c 50 -d 240 -q 1024 -n \"Company Event $(date +%Y-%m-%d)\"\n</code></pre>"},{"location":"examples/#export-voucher-codes","title":"Export Voucher Codes","text":"<pre><code>./ui lo vouchers list -o json | jq -r '.[] | select(.note | contains(\"Event\")) | .code' &gt; voucher-codes.txt\n</code></pre>"},{"location":"examples/#clean-up-expired-vouchers","title":"Clean Up Expired Vouchers","text":"<pre><code># List expired vouchers (used or past duration)\n./ui lo vouchers list -o json | jq '.[] | select(.used &gt;= .quota or .expired == true)'\n</code></pre>"},{"location":"examples/#network-monitoring","title":"Network Monitoring","text":""},{"location":"examples/#device-health-check","title":"Device Health Check","text":"<pre><code>#!/bin/bash\necho \"=== UniFi Network Health Check ===\"\necho \"\"\n\necho \"\ud83d\udce1 Site Health:\"\n./ui lo health\necho \"\"\n\necho \"\ud83d\udcca Device Status:\"\n./ui lo devices list | head -20\necho \"\"\n\necho \"\ud83d\udc65 Connected Clients:\"\n./ui lo clients count\necho \"\"\n\necho \"\ud83c\udf10 ISP Status (last reading):\"\n./ui isp metrics -i 5m -o json | jq -r '.[-1] | \"Latency: \\(.latency_avg)ms | Down: \\(.download_speed)Mbps | Up: \\(.upload_speed)Mbps\"'\n</code></pre>"},{"location":"examples/#find-devices-with-poor-signal","title":"Find Devices with Poor Signal","text":"<pre><code># Wireless clients with signal worse than -70 dBm\n./ui lo clients list -W -o json | jq '.[] | select(.rssi &lt; -70) | {name, rssi, ap: .ap_name}'\n</code></pre>"},{"location":"examples/#track-bandwidth-by-network","title":"Track Bandwidth by Network","text":"<pre><code>./ui lo clients list -o json | jq -r 'group_by(.network) | .[] | {network: .[0].network, total_rx: (map(.rx_bytes) | add), total_tx: (map(.tx_bytes) | add)}'\n</code></pre>"},{"location":"examples/#integration-examples","title":"Integration Examples","text":""},{"location":"examples/#slack-notification","title":"Slack Notification","text":"<pre><code>#!/bin/bash\nWEBHOOK_URL=\"https://hooks.slack.com/services/xxx\"\nOFFLINE=$(./ui devices list -o json | jq '[.[] | select(.status == \"offline\")] | length')\n\nif [ \"$OFFLINE\" -gt 0 ]; then\n    curl -X POST -H 'Content-type: application/json' \\\n        --data \"{\\\"text\\\":\\\"\u26a0\ufe0f $OFFLINE UniFi devices are offline!\\\"}\" \\\n        \"$WEBHOOK_URL\"\nfi\n</code></pre>"},{"location":"examples/#influxdb-export","title":"InfluxDB Export","text":"<pre><code>#!/bin/bash\n# Export ISP metrics to InfluxDB\n./ui isp metrics -i 5m -o json | jq -c '.[]' | while read line; do\n    timestamp=$(echo $line | jq -r '.timestamp')\n    latency=$(echo $line | jq -r '.latency_avg')\n    download=$(echo $line | jq -r '.download_speed')\n\n    curl -i -XPOST 'http://localhost:8086/write?db=unifi' \\\n        --data-binary \"isp_metrics latency=$latency,download=$download $timestamp\"\ndone\n</code></pre>"},{"location":"examples/#shell-aliases","title":"Shell Aliases","text":"<p>Add to your <code>.bashrc</code> or <code>.zshrc</code>:</p> <pre><code># UI-CLI aliases\nalias ui='./ui'\nalias clients='./ui lo clients'\nalias devices='./ui lo devices'\nalias health='./ui lo health'\nalias config='./ui lo config show'\n\n# Quick commands\nalias whoson='./ui lo clients list'\nalias offline='./ui devices list -o json | jq \".[] | select(.status == \\\"offline\\\")\"'\nalias backup='./ui lo config show -o yaml &gt; ~/unifi-backup-$(date +%Y%m%d).yaml'\n</code></pre>"},{"location":"examples/#tips","title":"Tips","text":""},{"location":"examples/#use-watch-for-live-monitoring","title":"Use <code>watch</code> for Live Monitoring","text":"<pre><code># Update every 5 seconds\nwatch -n 5 './ui lo clients count'\n</code></pre>"},{"location":"examples/#combine-with-grep","title":"Combine with <code>grep</code>","text":"<pre><code># Quick search\n./ui lo clients list | grep -i iphone\n./ui lo devices list | grep -i offline\n</code></pre>"},{"location":"examples/#pretty-json-output","title":"Pretty JSON Output","text":"<pre><code>./ui devices list -o json | jq '.'\n</code></pre>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Get up and running with UI-CLI in under 5 minutes.</p>"},{"location":"getting-started/#quick-install","title":"Quick Install","text":"<pre><code># Clone the repository\ngit clone https://github.com/vedanta/ui-cli.git\ncd ui-cli\n\n# Install (choose one)\npip install -e .                    # Using pip\n# OR\nconda env create -f environment.yml  # Using conda\nconda activate ui-cli\npip install -e .\n</code></pre>"},{"location":"getting-started/#configure","title":"Configure","text":"<p>Create a <code>.env</code> file in the project root:</p> <pre><code>cp .env.example .env\n</code></pre> <p>Edit <code>.env</code> with your credentials:</p> Cloud APILocal ControllerBoth <pre><code># Get your API key from: https://unifi.ui.com \u2192 Settings \u2192 API\nUNIFI_API_KEY=your-api-key-here\n</code></pre> <pre><code>UNIFI_CONTROLLER_URL=https://192.168.1.1\nUNIFI_CONTROLLER_USERNAME=admin\nUNIFI_CONTROLLER_PASSWORD=yourpassword\nUNIFI_CONTROLLER_SITE=default\nUNIFI_CONTROLLER_VERIFY_SSL=false\n</code></pre> <pre><code># Cloud API\nUNIFI_API_KEY=your-api-key-here\n\n# Local Controller\nUNIFI_CONTROLLER_URL=https://192.168.1.1\nUNIFI_CONTROLLER_USERNAME=admin\nUNIFI_CONTROLLER_PASSWORD=yourpassword\nUNIFI_CONTROLLER_SITE=default\nUNIFI_CONTROLLER_VERIFY_SSL=false\n</code></pre>"},{"location":"getting-started/#verify-installation","title":"Verify Installation","text":"<pre><code># Check Cloud API connection\n./ui status\n\n# Check Local Controller connection\n./ui lo health\n</code></pre>"},{"location":"getting-started/#your-first-commands","title":"Your First Commands","text":""},{"location":"getting-started/#cloud-api","title":"Cloud API","text":"<pre><code># List all your controllers\n./ui hosts list\n\n# List all devices across all sites\n./ui devices list\n\n# Check ISP performance\n./ui isp metrics\n</code></pre>"},{"location":"getting-started/#local-controller","title":"Local Controller","text":"<pre><code># List connected clients\n./ui lo clients list\n\n# Get detailed client status\n./ui lo clients status my-iPhone\n\n# List network devices\n./ui lo devices list\n</code></pre>"},{"location":"getting-started/#output-formats","title":"Output Formats","text":"<p>All commands support multiple output formats:</p> <pre><code>./ui devices list              # Table (default)\n./ui devices list -o json      # JSON (for scripting)\n./ui devices list -o csv       # CSV (for spreadsheets)\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>Installation - Detailed installation options</li> <li>Configuration - All configuration options</li> <li>Commands - Full command reference</li> <li>Examples - Real-world usage examples</li> </ul>"},{"location":"groups/","title":"Client Groups","text":"<p>Create named groups of client devices for bulk actions like blocking, unblocking, and monitoring. Groups are stored locally and do not require a network connection to manage.</p>"},{"location":"groups/#overview","title":"Overview","text":"<p>Client groups allow you to:</p> <ul> <li>Organize devices - Group devices by purpose (Kids, IoT, Guests)</li> <li>Bulk actions - Block/unblock/kick all devices in a group at once</li> <li>Parental controls - Implement bedtime rules by blocking a group</li> <li>Network segmentation - Monitor and manage device categories</li> </ul>"},{"location":"groups/#group-types","title":"Group Types","text":""},{"location":"groups/#static-groups","title":"Static Groups","text":"<p>Static groups have a manually maintained list of members, identified by MAC address.</p> <pre><code># Create a static group\n./ui groups create \"Kids Devices\" -d \"Tablets and phones for the kids\"\n\n# Add members with optional aliases\n./ui groups add kids-devices AA:BB:CC:DD:EE:FF -a \"Timmy iPad\"\n./ui groups add kids-devices 11:22:33:44:55:66 -a \"Sarah Phone\"\n</code></pre>"},{"location":"groups/#auto-groups","title":"Auto Groups","text":"<p>Auto groups dynamically match clients based on rules. Members are evaluated at query time against live client data.</p> <pre><code># Create auto group matching Apple devices\n./ui groups auto \"Apple Devices\" --vendor \"Apple\"\n\n# Create auto group matching devices by name pattern\n./ui groups auto \"Cameras\" --name \"*camera*,*cam*\"\n</code></pre>"},{"location":"groups/#pattern-syntax","title":"Pattern Syntax","text":"<p>Auto group rules support multiple pattern formats:</p> Format Example Matches Exact <code>Apple</code> \"Apple\" only Wildcard <code>*phone*</code> \"iPhone\", \"Android Phone\", \"phone-1\" Prefix <code>iPhone*</code> \"iPhone\", \"iPhone-12\", \"iPhoneXR\" Suffix <code>*-TV</code> \"Living-TV\", \"Bedroom-TV\" Regex <code>~^iPhone-[0-9]+$</code> \"iPhone-1\", \"iPhone-12\" (not \"iPhoneXR\") Multiple <code>Apple,Samsung</code> \"Apple\" OR \"Samsung\" <p>Pattern Rules: - Patterns are case-insensitive - <code>*</code> matches any characters (including none) - <code>?</code> matches exactly one character - Prefix with <code>~</code> for regex patterns - Comma-separated patterns use OR logic - Different rule types use AND logic</p>"},{"location":"groups/#commands-reference","title":"Commands Reference","text":""},{"location":"groups/#group-management","title":"Group Management","text":"<pre><code># List all groups\n./ui groups list\n./ui groups ls                    # Alias\n\n# Create static group\n./ui groups create \"My Group\"\n./ui groups create \"My Group\" -d \"Description here\"\n\n# Show group details\n./ui groups show \"My Group\"\n./ui groups show my-group         # Use slug\n\n# Edit group\n./ui groups edit my-group -n \"New Name\"\n./ui groups edit my-group -d \"New description\"\n\n# Delete group\n./ui groups delete my-group\n./ui groups delete my-group -y    # Skip confirmation\n./ui groups rm my-group           # Alias\n</code></pre>"},{"location":"groups/#member-management-static-groups","title":"Member Management (Static Groups)","text":"<pre><code># Add members\n./ui groups add my-group AA:BB:CC:DD:EE:FF\n./ui groups add my-group AA:BB:CC:DD:EE:FF -a \"Device Name\"\n./ui groups add my-group MAC1 MAC2 MAC3    # Multiple\n\n# Remove members\n./ui groups remove my-group AA:BB:CC:DD:EE:FF\n./ui groups remove my-group \"Device Name\"   # By alias\n\n# Set or clear alias\n./ui groups alias my-group AA:BB:CC:DD:EE:FF \"New Alias\"\n./ui groups alias my-group AA:BB:CC:DD:EE:FF --clear\n\n# List members\n./ui groups members my-group\n./ui groups members my-group -o json\n\n# Clear all members\n./ui groups clear my-group\n./ui groups clear my-group -y     # Skip confirmation\n</code></pre>"},{"location":"groups/#auto-groups_1","title":"Auto Groups","text":"<pre><code># Create auto group with rules\n./ui groups auto \"Group Name\" [OPTIONS]\n\n# Available rule options:\n--vendor \"Apple\"              # Match by vendor/OUI\n--name \"*phone*\"              # Match by client name\n--hostname \"iphone*\"          # Match by hostname\n--network \"Guest\"             # Match by network/SSID\n--ip \"192.168.1.100-200\"      # Match by IP range\n--mac \"AA:BB:*\"               # Match by MAC prefix\n--type \"wireless\"             # Match by connection type\n\n# Examples\n./ui groups auto \"Apple Devices\" --vendor \"Apple\"\n./ui groups auto \"IoT\" --vendor \"Philips,LIFX,Ring,Nest\"\n./ui groups auto \"Cameras\" --name \"*camera*,*cam*\"\n./ui groups auto \"Guest WiFi\" --network \"Guest\"\n./ui groups auto \"Servers\" --ip \"192.168.1.100-200\"\n./ui groups auto \"Wireless\" --type \"wireless\"\n\n# Combine rules (AND logic)\n./ui groups auto \"Kids iPhones\" --vendor \"Apple\" --name \"*kid*\"\n\n# Preview without creating\n./ui groups auto \"Test\" --vendor \"Apple\" --dry-run\n</code></pre>"},{"location":"groups/#importexport","title":"Import/Export","text":"<pre><code># Export all groups to JSON\n./ui groups export\n./ui groups export -o groups-backup.json\n\n# Import groups from file\n./ui groups import groups-backup.json\n./ui groups import groups-backup.json --replace    # Replace all existing\n./ui groups import groups-backup.json -y           # Skip confirmation\n</code></pre>"},{"location":"groups/#bulk-actions","title":"Bulk Actions","text":"<p>Use the <code>-g</code> / <code>--group</code> flag with client commands to perform bulk operations.</p>"},{"location":"groups/#list-group-clients","title":"List Group Clients","text":"<pre><code># List all clients matching a group\n./ui lo clients list -g kids-devices\n./ui lo clients list -g apple-devices -o json\n</code></pre>"},{"location":"groups/#block-all-clients","title":"Block All Clients","text":"<pre><code># Block all clients in a group\n./ui lo clients block -g kids-devices\n./ui lo clients block -g kids-devices -y    # Skip confirmation\n\n# Returns summary:\n# Blocked 3 clients (already blocked: 1, failed: 0)\n</code></pre>"},{"location":"groups/#unblock-all-clients","title":"Unblock All Clients","text":"<pre><code># Unblock all clients in a group\n./ui lo clients unblock -g kids-devices\n./ui lo clients unblock -g kids-devices -y\n\n# Returns summary:\n# Unblocked 3 clients (not blocked: 1, failed: 0)\n</code></pre>"},{"location":"groups/#kickdisconnect-all-clients","title":"Kick/Disconnect All Clients","text":"<pre><code># Force disconnect all clients in a group\n./ui lo clients kick -g kids-devices\n./ui lo clients kick -g kids-devices -y\n\n# Returns summary:\n# Kicked 3 clients (offline: 1, failed: 0)\n</code></pre>"},{"location":"groups/#use-cases","title":"Use Cases","text":""},{"location":"groups/#parental-controls","title":"Parental Controls","text":"<p>Create a group for kids' devices and block at bedtime:</p> <pre><code># Setup (one time)\n./ui groups create \"Kids Devices\"\n./ui groups add kids-devices AA:BB:CC:DD:EE:FF -a \"Timmy iPad\"\n./ui groups add kids-devices 11:22:33:44:55:66 -a \"Sarah Phone\"\n./ui groups add kids-devices 22:33:44:55:66:77 -a \"Gaming Console\"\n\n# Bedtime - block all\n./ui lo clients block -g kids-devices -y\n\n# Morning - unblock all\n./ui lo clients unblock -g kids-devices -y\n</code></pre>"},{"location":"groups/#iot-device-management","title":"IoT Device Management","text":"<p>Group smart home devices by vendor:</p> <pre><code># Create auto groups for IoT vendors\n./ui groups auto \"Smart Lights\" --vendor \"Philips,LIFX,Hue\"\n./ui groups auto \"Cameras\" --vendor \"Ring,Nest,Wyze\"\n./ui groups auto \"Smart Speakers\" --vendor \"Amazon,Google,Sonos\"\n\n# Check status of all cameras\n./ui lo clients list -g cameras\n\n# Temporarily disconnect all smart speakers\n./ui lo clients kick -g smart-speakers -y\n</code></pre>"},{"location":"groups/#guest-network-monitoring","title":"Guest Network Monitoring","text":"<p>Track devices on guest network:</p> <pre><code># Create auto group for guest network\n./ui groups auto \"Guest Devices\" --network \"Guest\"\n\n# List current guests\n./ui lo clients list -g guest-devices\n\n# Count guests\n./ui lo clients list -g guest-devices -o json | jq 'length'\n</code></pre>"},{"location":"groups/#serverinfrastructure-isolation","title":"Server/Infrastructure Isolation","text":"<p>Group servers by IP range:</p> <pre><code># Create auto group for server VLAN\n./ui groups auto \"Servers\" --ip \"10.0.10.0/24\"\n\n# Or by IP range\n./ui groups auto \"Servers\" --ip \"192.168.1.100-150\"\n\n# Monitor server connectivity\n./ui lo clients list -g servers\n</code></pre>"},{"location":"groups/#storage","title":"Storage","text":"<p>Groups are stored in <code>~/.config/ui-cli/groups.json</code>:</p> <pre><code>{\n  \"version\": 1,\n  \"groups\": {\n    \"kids-devices\": {\n      \"name\": \"Kids Devices\",\n      \"description\": \"Tablets and phones\",\n      \"type\": \"static\",\n      \"members\": [\n        {\"mac\": \"AA:BB:CC:DD:EE:FF\", \"alias\": \"Timmy iPad\"},\n        {\"mac\": \"11:22:33:44:55:66\", \"alias\": \"Sarah Phone\"}\n      ],\n      \"created_at\": \"2024-01-15T10:30:00Z\",\n      \"updated_at\": \"2024-01-15T10:35:00Z\"\n    },\n    \"apple-devices\": {\n      \"name\": \"Apple Devices\",\n      \"type\": \"auto\",\n      \"rules\": {\n        \"vendor\": [\"Apple\"]\n      },\n      \"created_at\": \"2024-01-15T11:00:00Z\",\n      \"updated_at\": \"2024-01-15T11:00:00Z\"\n    }\n  }\n}\n</code></pre>"},{"location":"groups/#mcp-integration","title":"MCP Integration","text":"<p>Groups are available through Claude Desktop via MCP tools:</p> Tool Description Example Prompt <code>list_groups</code> List all groups \"What groups do I have?\" <code>get_group</code> Get group details \"Show the kids devices group\" <code>block_group</code> Block all in group \"Block all kids devices\" <code>unblock_group</code> Unblock all in group \"Unblock the kids devices\" <code>group_status</code> Live status of group \"Are the kids devices online?\""},{"location":"groups/#example-conversations","title":"Example Conversations","text":"<p>You: Block all kids devices, it's bedtime</p> <p>Claude: I'll block all devices in the \"Kids Devices\" group.</p> <p>Done! Blocked 3 clients (1 was already blocked).</p> <p>You: What's the status of my IoT devices?</p> <p>Claude: Looking at your \"IoT Devices\" group...</p> <p>You have 12 IoT devices: - 10 online - 2 offline (Garage Sensor, Basement Camera)</p>"},{"location":"groups/#tips","title":"Tips","text":"<ol> <li>Use slugs for scripting - Group slugs (lowercase, hyphenated) are more reliable than names</li> <li>Combine with cron - Automate bedtime rules with scheduled tasks</li> <li>Backup groups - Use <code>./ui groups export</code> before major changes</li> <li>Preview auto groups - Use <code>--dry-run</code> to test rules before creating</li> <li>MAC addresses - Can use colons (AA:BB:CC) or hyphens (AA-BB-CC)</li> </ol>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.10 or higher</li> <li>pip or conda</li> </ul>"},{"location":"installation/#install-with-pip","title":"Install with pip","text":"<pre><code># Clone the repository\ngit clone https://github.com/vedanta/ui-cli.git\ncd ui-cli\n\n# Create virtual environment (recommended)\npython -m venv venv\nsource venv/bin/activate  # Linux/macOS\n# or\n.\\venv\\Scripts\\activate   # Windows\n\n# Install\npip install -e .\n</code></pre>"},{"location":"installation/#install-with-conda","title":"Install with Conda","text":"<pre><code># Clone the repository\ngit clone https://github.com/vedanta/ui-cli.git\ncd ui-cli\n\n# Create conda environment\nconda env create -f environment.yml\nconda activate ui-cli\n\n# Install\npip install -e .\n</code></pre>"},{"location":"installation/#development-installation","title":"Development Installation","text":"<p>For contributing or development:</p> <pre><code>pip install -e \".[dev]\"\n</code></pre> <p>This includes:</p> <ul> <li>pytest - Testing framework</li> <li>pytest-asyncio - Async test support</li> <li>ruff - Linting</li> <li>mypy - Type checking</li> </ul>"},{"location":"installation/#verify-installation","title":"Verify Installation","text":"<pre><code># Using the wrapper script\n./ui --help\n\n# Or directly after pip install\nui --help\n</code></pre> <p>Expected output:</p> <pre><code>Usage: ui [OPTIONS] COMMAND [ARGS]...\n\n  UniFi CLI - Manage your UniFi infrastructure from the command line.\n\nOptions:\n  --help  Show this message and exit.\n\nCommands:\n  devices    Manage UniFi devices\n  hosts      Manage UniFi hosts\n  isp        ISP metrics and information\n  local      Local UniFi Controller commands (alias: lo)\n  sdwan      SD-WAN configuration management\n  sites      Manage UniFi sites\n  speedtest  Run a speed test\n  status     Check API connection status\n  version    Show version information\n</code></pre>"},{"location":"installation/#updating","title":"Updating","text":"<pre><code>cd ui-cli\ngit pull origin main\npip install -e .\n</code></pre>"},{"location":"installation/#uninstalling","title":"Uninstalling","text":"<pre><code>pip uninstall ui-cli\n\n# If using conda\nconda deactivate\nconda env remove -n ui-cli\n</code></pre>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions.</p>"},{"location":"troubleshooting/#cloud-api-issues","title":"Cloud API Issues","text":""},{"location":"troubleshooting/#api-key-not-configured","title":"\"API key not configured\"","text":"<p>Problem: Missing or empty <code>UNIFI_API_KEY</code> in <code>.env</code></p> <p>Solution: <pre><code># Check if .env exists\ncat .env | grep UNIFI_API_KEY\n\n# Add your API key\necho 'UNIFI_API_KEY=your-key-here' &gt;&gt; .env\n</code></pre></p>"},{"location":"troubleshooting/#invalid-api-key","title":"\"Invalid API key\"","text":"<p>Problem: API key is incorrect or expired</p> <p>Solution:</p> <ol> <li>Go to unifi.ui.com</li> <li>Navigate to Settings \u2192 API</li> <li>Delete the old key and create a new one</li> <li>Update <code>.env</code> with the new key</li> </ol>"},{"location":"troubleshooting/#connection-timeout","title":"\"Connection timeout\"","text":"<p>Problem: Cannot reach <code>api.ui.com</code></p> <p>Solution:</p> <ul> <li>Check internet connectivity</li> <li>Verify firewall allows outbound HTTPS</li> <li>Try: <code>curl -I https://api.ui.com</code></li> </ul>"},{"location":"troubleshooting/#local-controller-issues","title":"Local Controller Issues","text":""},{"location":"troubleshooting/#controller-url-not-configured","title":"\"Controller URL not configured\"","text":"<p>Problem: Missing <code>UNIFI_CONTROLLER_URL</code> in <code>.env</code></p> <p>Solution: <pre><code># Add your controller URL\necho 'UNIFI_CONTROLLER_URL=https://192.168.1.1' &gt;&gt; .env\n</code></pre></p>"},{"location":"troubleshooting/#invalid-username-or-password","title":"\"Invalid username or password\"","text":"<p>Problem: Credentials don't match controller</p> <p>Solution:</p> <ol> <li>Verify credentials work in the UniFi web UI</li> <li>Use a local admin account (not Ubiquiti SSO)</li> <li>Check for typos in <code>.env</code></li> </ol> <p>SSO vs Local Accounts</p> <p>UI-CLI requires a local admin account. Ubiquiti SSO accounts won't work for direct controller access.</p>"},{"location":"troubleshooting/#ssl-certificate-verify-failed","title":"\"SSL certificate verify failed\"","text":"<p>Problem: Controller uses self-signed certificate</p> <p>Solution: <pre><code># Disable SSL verification\necho 'UNIFI_CONTROLLER_VERIFY_SSL=false' &gt;&gt; .env\n</code></pre></p>"},{"location":"troubleshooting/#connection-refused","title":"\"Connection refused\"","text":"<p>Problem: Cannot connect to controller</p> <p>Solution:</p> <ul> <li>Verify controller URL is correct</li> <li>Check controller is running</li> <li>Ensure network access to controller</li> <li>Try: <code>curl -k https://192.168.1.1</code></li> </ul>"},{"location":"troubleshooting/#session-expired","title":"\"Session expired\"","text":"<p>Problem: Cached session is no longer valid</p> <p>Solution: <pre><code># Delete cached session\nrm ~/.config/ui-cli/session.json\n\n# Try again\n./ui lo health\n</code></pre></p>"},{"location":"troubleshooting/#clientdevice-issues","title":"Client/Device Issues","text":""},{"location":"troubleshooting/#client-not-found","title":"\"Client not found\"","text":"<p>Problem: Client name or MAC not recognized</p> <p>Solution:</p> <ul> <li>Try partial name match: <code>./ui lo clients get iPhone</code></li> <li>Use MAC address: <code>./ui lo clients get AA:BB:CC:DD:EE:FF</code></li> <li>List all clients: <code>./ui lo clients all</code></li> </ul>"},{"location":"troubleshooting/#device-not-found","title":"\"Device not found\"","text":"<p>Problem: Device identifier not recognized</p> <p>Solution:</p> <ul> <li>List devices first: <code>./ui lo devices list</code></li> <li>Try by MAC: <code>./ui lo devices get 70:a7:41:xx:xx:xx</code></li> <li>Try by ID: <code>./ui lo devices get device-001</code></li> </ul>"},{"location":"troubleshooting/#dpi-issues","title":"DPI Issues","text":""},{"location":"troubleshooting/#dpi-unavailable","title":"\"DPI unavailable\"","text":"<p>Problem: DPI is not enabled on the controller</p> <p>Solution:</p> <ol> <li>Open UniFi web UI</li> <li>Go to Settings \u2192 Traffic &amp; Security \u2192 Deep Packet Inspection</li> <li>Enable DPI</li> <li>Wait a few hours for data to populate</li> </ol>"},{"location":"troubleshooting/#output-issues","title":"Output Issues","text":""},{"location":"troubleshooting/#json-output-is-empty","title":"JSON Output is Empty","text":"<p>Problem: Command returns <code>[]</code> or <code>{}</code></p> <p>Possible Causes:</p> <ul> <li>No data available (e.g., no vouchers created)</li> <li>Filter too restrictive</li> <li>API returned empty response</li> </ul> <p>Debug: <pre><code># Remove filters and try verbose\n./ui lo clients list -v\n./ui lo vouchers list -v\n</code></pre></p>"},{"location":"troubleshooting/#table-output-truncated","title":"Table Output Truncated","text":"<p>Problem: Long values cut off in table view</p> <p>Solution: <pre><code># Use JSON for full data\n./ui devices list -o json | jq '.[0]'\n\n# Or CSV\n./ui devices list -o csv\n</code></pre></p>"},{"location":"troubleshooting/#installation-issues","title":"Installation Issues","text":""},{"location":"troubleshooting/#modulenotfounderror","title":"\"ModuleNotFoundError\"","text":"<p>Problem: Python dependencies not installed</p> <p>Solution: <pre><code>pip install -e .\n# or\npip install -e \".[dev]\"\n</code></pre></p>"},{"location":"troubleshooting/#command-not-found-ui","title":"\"Command not found: ui\"","text":"<p>Problem: CLI not in PATH</p> <p>Solution: <pre><code># Use the wrapper script\n./ui --help\n\n# Or add to PATH after pip install\nwhich ui\n</code></pre></p>"},{"location":"troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"troubleshooting/#check-version","title":"Check Version","text":"<pre><code>./ui version\n</code></pre>"},{"location":"troubleshooting/#command-help","title":"Command Help","text":"<pre><code>./ui --help\n./ui lo --help\n./ui lo clients --help\n</code></pre>"},{"location":"troubleshooting/#debug-mode","title":"Debug Mode","text":"<pre><code># See what's happening\n./ui lo health -v\n</code></pre>"},{"location":"troubleshooting/#report-issues","title":"Report Issues","text":"<p>Found a bug? Open an issue on GitHub</p> <p>Include:</p> <ul> <li>UI-CLI version (<code>./ui version</code>)</li> <li>Controller type (UDM, Cloud Key, etc.)</li> <li>Error message</li> <li>Steps to reproduce</li> </ul>"},{"location":"commands/","title":"Command Reference","text":"<p>UI-CLI provides four interfaces:</p> <ul> <li>Cloud API - Commands via <code>api.ui.com</code> for multi-site management</li> <li>Local Controller - Direct connection to your controller for real-time operations</li> <li>Client Groups - Create named groups for bulk actions (parental controls, IoT management)</li> <li>Claude Desktop - Natural language control via MCP integration</li> </ul>"},{"location":"commands/#command-tree","title":"Command Tree","text":"<pre><code>./ui\n\u251c\u2500\u2500 status              # Check API connection\n\u251c\u2500\u2500 version             # Show CLI version\n\u251c\u2500\u2500 speedtest           # Run speedtest on gateway\n\u251c\u2500\u2500 hosts               # Cloud: manage controllers\n\u251c\u2500\u2500 sites               # Cloud: manage sites\n\u251c\u2500\u2500 devices             # Cloud: manage devices\n\u251c\u2500\u2500 isp                 # Cloud: ISP metrics\n\u251c\u2500\u2500 sdwan               # Cloud: SD-WAN configs\n\u251c\u2500\u2500 groups              # Client groups for bulk actions\n\u251c\u2500\u2500 local (lo)          # Local controller commands\n\u2514\u2500\u2500 mcp                 # Claude Desktop integration\n</code></pre>"},{"location":"commands/#quick-reference","title":"Quick Reference","text":""},{"location":"commands/#cloud-api","title":"Cloud API","text":"Command Description <code>./ui status</code> Check API connection <code>./ui hosts list</code> List all controllers <code>./ui sites list</code> List all sites <code>./ui devices list</code> List all devices <code>./ui devices count --by model</code> Count devices by model <code>./ui isp metrics</code> ISP performance metrics <code>./ui sdwan list</code> List SD-WAN configs"},{"location":"commands/#local-controller","title":"Local Controller","text":"Command Description <code>./ui lo health</code> Site health summary <code>./ui lo clients list</code> List connected clients <code>./ui lo clients status &lt;name&gt;</code> Detailed client status <code>./ui lo devices list</code> List network devices <code>./ui lo devices restart &lt;name&gt;</code> Restart a device <code>./ui lo networks list</code> List networks/VLANs <code>./ui lo firewall list</code> List firewall rules <code>./ui lo vouchers create</code> Create guest voucher <code>./ui lo dpi stats</code> DPI statistics <code>./ui lo stats daily</code> Daily traffic stats <code>./ui lo config show</code> Export running config"},{"location":"commands/#client-groups","title":"Client Groups","text":"Command Description <code>./ui groups list</code> List all groups <code>./ui groups create \"Name\"</code> Create static group <code>./ui groups auto \"Name\" --vendor \"Apple\"</code> Create auto group <code>./ui groups add &lt;group&gt; &lt;MAC&gt;</code> Add member to group <code>./ui groups show &lt;group&gt;</code> Show group details <code>./ui lo clients list -g &lt;group&gt;</code> List clients in group <code>./ui lo clients block -g &lt;group&gt;</code> Block all in group <code>./ui lo clients unblock -g &lt;group&gt;</code> Unblock all in group <p>See Client Groups for full documentation.</p>"},{"location":"commands/#claude-desktop-mcp","title":"Claude Desktop (MCP)","text":"Tool Description <code>network_health</code> Network health summary <code>client_count</code> Count connected clients <code>find_client</code> Find client by name <code>block_client</code> Block a client <code>block_group</code> Block all clients in a group <code>restart_device</code> Restart a device <code>create_voucher</code> Create guest WiFi code <p>See Claude Desktop for full tool list and setup instructions.</p>"},{"location":"commands/#output-formats","title":"Output Formats","text":"<p>All commands support multiple output formats:</p> <pre><code>./ui devices list              # Table (default)\n./ui devices list -o json      # JSON\n./ui devices list -o csv       # CSV\n./ui lo config show -o yaml    # YAML (config only)\n</code></pre>"},{"location":"commands/#common-options","title":"Common Options","text":"Option Short Description <code>--output</code> <code>-o</code> Output format: table/json/csv/yaml <code>--verbose</code> <code>-v</code> Show additional details <code>--yes</code> <code>-y</code> Skip confirmation prompts <code>--help</code> Show command help"},{"location":"commands/#getting-help","title":"Getting Help","text":"<pre><code>./ui --help                    # All commands\n./ui devices --help            # Device commands\n./ui lo --help                 # Local commands\n./ui lo clients --help         # Client commands\n</code></pre>"},{"location":"commands/cloud/","title":"Cloud API Commands","text":"<p>Commands that use the UniFi Site Manager API (<code>api.ui.com</code>). These allow you to manage multiple sites from anywhere.</p>"},{"location":"commands/cloud/#prerequisites","title":"Prerequisites","text":"<ul> <li><code>UNIFI_API_KEY</code> configured in <code>.env</code></li> <li>Internet access to <code>api.ui.com</code></li> </ul>"},{"location":"commands/cloud/#status","title":"Status","text":"<p>Check API connection and authentication.</p> <pre><code>./ui status\n./ui status -o json      # JSON output for scripting\n</code></pre>"},{"location":"commands/cloud/#hosts","title":"Hosts","text":"<p>Manage UniFi controllers (UDM, Cloud Key, etc.)</p>"},{"location":"commands/cloud/#list-hosts","title":"List Hosts","text":"<pre><code>./ui hosts list\n./ui hosts list -v              # Verbose\n./ui hosts list -o json         # JSON output\n./ui hosts list -o csv          # CSV export\n</code></pre>"},{"location":"commands/cloud/#get-host-details","title":"Get Host Details","text":"<pre><code>./ui hosts get HOST_ID\n./ui hosts get HOST_ID -v       # Verbose\n</code></pre>"},{"location":"commands/cloud/#sites","title":"Sites","text":"<p>Manage UniFi sites.</p>"},{"location":"commands/cloud/#list-sites","title":"List Sites","text":"<pre><code>./ui sites list\n./ui sites list -v              # Verbose\n./ui sites list -o json         # JSON output\n</code></pre>"},{"location":"commands/cloud/#devices","title":"Devices","text":"<p>Manage UniFi devices across all sites.</p>"},{"location":"commands/cloud/#list-devices","title":"List Devices","text":"<pre><code>./ui devices list\n./ui devices list --host HOST_ID    # Filter by controller\n./ui devices list -v                # Verbose\n./ui devices list -o csv            # CSV export\n</code></pre>"},{"location":"commands/cloud/#count-devices","title":"Count Devices","text":"<p>Group and count devices by various fields.</p> <pre><code>./ui devices count                  # Total count\n./ui devices count --by model       # By device model\n./ui devices count --by status      # By online/offline status\n./ui devices count --by host        # By controller\n./ui devices count --by product-line # By type (network, protect, etc.)\n</code></pre>"},{"location":"commands/cloud/#isp-metrics","title":"ISP Metrics","text":"<p>View ISP performance metrics.</p> <pre><code>./ui isp metrics                    # Last 7 days, hourly\n./ui isp metrics -i 5m              # 5-minute intervals (last 24h)\n./ui isp metrics --hours 48         # Last 48 hours\n./ui isp metrics -o csv             # CSV export\n</code></pre> <p>Available Intervals:</p> Interval Data Range <code>5m</code> Last 24 hours <code>1h</code> Last 7 days (default) <p>Metrics Returned:</p> <ul> <li>Latency (average and max)</li> <li>Download/upload speeds</li> <li>Uptime percentage</li> <li>Packet loss</li> <li>ISP name</li> </ul>"},{"location":"commands/cloud/#sd-wan","title":"SD-WAN","text":"<p>Manage SD-WAN configurations.</p>"},{"location":"commands/cloud/#list-configurations","title":"List Configurations","text":"<pre><code>./ui sdwan list\n./ui sdwan list -v              # Verbose\n</code></pre>"},{"location":"commands/cloud/#get-configuration","title":"Get Configuration","text":"<pre><code>./ui sdwan get CONFIG_ID\n./ui sdwan get CONFIG_ID -v     # Verbose\n</code></pre>"},{"location":"commands/cloud/#check-status","title":"Check Status","text":"<pre><code>./ui sdwan status CONFIG_ID\n</code></pre>"},{"location":"commands/cloud/#version","title":"Version","text":"<pre><code>./ui version\n</code></pre>"},{"location":"commands/cloud/#examples","title":"Examples","text":""},{"location":"commands/cloud/#export-all-devices-to-csv","title":"Export All Devices to CSV","text":"<pre><code>./ui devices list -o csv &gt; devices.csv\n</code></pre>"},{"location":"commands/cloud/#find-offline-devices","title":"Find Offline Devices","text":"<pre><code>./ui devices count --by status\n# or with jq\n./ui devices list -o json | jq '[.[] | select(.status == \"offline\")]'\n</code></pre>"},{"location":"commands/cloud/#check-isp-performance","title":"Check ISP Performance","text":"<pre><code>./ui isp metrics -i 5m -o json | jq '.[-1]'  # Latest reading\n</code></pre>"},{"location":"commands/cloud/#script-alert-on-offline-devices","title":"Script: Alert on Offline Devices","text":"<pre><code>#!/bin/bash\nOFFLINE=$(./ui devices count --by status -o json | jq '.counts.offline // 0')\nif [ \"$OFFLINE\" -gt 0 ]; then\n    echo \"Warning: $OFFLINE devices offline\"\n    ./ui devices list -o json | jq '.[] | select(.status == \"offline\") | .name'\nfi\n</code></pre>"},{"location":"commands/local/","title":"Local Controller Commands","text":"<p>Commands that connect directly to your UniFi Controller. Use <code>./ui local</code> or the shorthand <code>./ui lo</code>.</p>"},{"location":"commands/local/#prerequisites","title":"Prerequisites","text":"<ul> <li><code>UNIFI_CONTROLLER_URL</code> configured in <code>.env</code></li> <li><code>UNIFI_CONTROLLER_USERNAME</code> and <code>UNIFI_CONTROLLER_PASSWORD</code> configured</li> <li>Network access to your controller</li> </ul>"},{"location":"commands/local/#health","title":"Health","text":"<p>Check site health status.</p> <pre><code>./ui lo health\n./ui lo health -v              # Verbose\n</code></pre> <p>Shows status of WAN, LAN, WLAN, and VPN subsystems.</p>"},{"location":"commands/local/#clients","title":"Clients","text":"<p>Manage network clients.</p>"},{"location":"commands/local/#list-clients","title":"List Clients","text":"<pre><code>./ui lo clients list           # Connected clients\n./ui lo clients list -w        # Wired only\n./ui lo clients list -W        # Wireless only\n./ui lo clients list -n Guest  # Filter by network\n./ui lo clients list -g kids   # Filter by group\n./ui lo clients list -v        # Verbose\n./ui lo clients all            # Include offline clients\n</code></pre>"},{"location":"commands/local/#get-client-details","title":"Get Client Details","text":"<pre><code>./ui lo clients get my-iPhone          # By name\n./ui lo clients get AA:BB:CC:DD:EE:FF  # By MAC\n./ui lo clients get iPhone             # Partial match\n</code></pre>"},{"location":"commands/local/#client-status","title":"Client Status","text":"<p>Comprehensive client information including signal, experience, and data usage.</p> <pre><code>./ui lo clients status my-iPhone\n</code></pre>"},{"location":"commands/local/#blockunblock-client","title":"Block/Unblock Client","text":"<pre><code>./ui lo clients block my-iPhone        # Block (with confirmation)\n./ui lo clients block my-iPhone -y     # Skip confirmation\n./ui lo clients unblock my-iPhone      # Unblock\n\n# Bulk actions with groups\n./ui lo clients block -g kids-devices -y     # Block all in group\n./ui lo clients unblock -g kids-devices -y   # Unblock all in group\n</code></pre>"},{"location":"commands/local/#disconnect-client","title":"Disconnect Client","text":"<pre><code>./ui lo clients kick my-iPhone         # Force reconnect\n./ui lo clients kick -g kids-devices -y  # Kick all in group\n</code></pre>"},{"location":"commands/local/#count-clients","title":"Count Clients","text":"<pre><code>./ui lo clients count                  # By connection type\n./ui lo clients count --by network     # By network/SSID\n./ui lo clients count --by vendor      # By manufacturer\n./ui lo clients count --by ap          # By access point\n./ui lo clients count --by experience  # By WiFi quality\n./ui lo clients count -a               # Include offline\n</code></pre>"},{"location":"commands/local/#find-duplicates","title":"Find Duplicates","text":"<p>Identify devices with multiple NICs or naming conflicts.</p> <pre><code>./ui lo clients duplicates\n</code></pre>"},{"location":"commands/local/#devices","title":"Devices","text":"<p>Manage network devices (APs, switches, gateways).</p>"},{"location":"commands/local/#list-devices","title":"List Devices","text":"<pre><code>./ui lo devices list\n./ui lo devices list -v        # Verbose (channels, load, etc.)\n</code></pre>"},{"location":"commands/local/#get-device-details","title":"Get Device Details","text":"<pre><code>./ui lo devices get UDM-Pro            # By name\n./ui lo devices get 70:a7:41:xx:xx:xx  # By MAC\n./ui lo devices get device-001         # By ID\n</code></pre>"},{"location":"commands/local/#restart-device","title":"Restart Device","text":"<pre><code>./ui lo devices restart UDM-Pro\n./ui lo devices restart UDM-Pro -y     # Skip confirmation\n</code></pre>"},{"location":"commands/local/#upgrade-firmware","title":"Upgrade Firmware","text":"<pre><code>./ui lo devices upgrade Office-AP\n./ui lo devices upgrade Office-AP -y   # Skip confirmation\n</code></pre>"},{"location":"commands/local/#locate-device","title":"Locate Device","text":"<p>Toggle the locate LED for physical identification.</p> <pre><code>./ui lo devices locate Office-AP       # Turn on LED\n./ui lo devices locate Office-AP --off # Turn off LED\n</code></pre>"},{"location":"commands/local/#adopt-device","title":"Adopt Device","text":"<p>Adopt a new device into the controller.</p> <pre><code>./ui lo devices adopt 70:a7:41:xx:xx:xx\n</code></pre>"},{"location":"commands/local/#networks","title":"Networks","text":"<p>View network configuration.</p>"},{"location":"commands/local/#list-networks","title":"List Networks","text":"<pre><code>./ui lo networks list\n./ui lo networks list -v       # Include DHCP details\n</code></pre>"},{"location":"commands/local/#get-network-details","title":"Get Network Details","text":"<pre><code>./ui lo networks get NETWORK_ID\n</code></pre>"},{"location":"commands/local/#firewall","title":"Firewall","text":"<p>Inspect firewall configuration.</p>"},{"location":"commands/local/#list-rules","title":"List Rules","text":"<pre><code>./ui lo firewall list\n./ui lo firewall list --ruleset WAN_IN    # Filter by ruleset\n./ui lo firewall list --ruleset LAN_IN\n./ui lo firewall list -v                   # Verbose\n</code></pre>"},{"location":"commands/local/#list-groups","title":"List Groups","text":"<p>View address and port groups.</p> <pre><code>./ui lo firewall groups\n./ui lo firewall groups -v     # Show group members\n</code></pre>"},{"location":"commands/local/#port-forwarding","title":"Port Forwarding","text":"<p>View port forwarding rules.</p> <pre><code>./ui lo portfwd list\n./ui lo portfwd list -v        # Verbose\n</code></pre>"},{"location":"commands/local/#vouchers","title":"Vouchers","text":"<p>Manage guest hotspot vouchers.</p>"},{"location":"commands/local/#list-vouchers","title":"List Vouchers","text":"<pre><code>./ui lo vouchers list\n./ui lo vouchers list -v       # Verbose\n</code></pre>"},{"location":"commands/local/#create-vouchers","title":"Create Vouchers","text":"<pre><code>./ui lo vouchers create                    # Single voucher, 24h\n./ui lo vouchers create -c 10              # Create 10 vouchers\n./ui lo vouchers create -d 60              # 60 minute duration\n./ui lo vouchers create -q 1024            # 1GB data quota\n./ui lo vouchers create --up 5000          # 5 Mbps upload limit\n./ui lo vouchers create --down 10000       # 10 Mbps download limit\n./ui lo vouchers create -n \"Conference\"    # Add note\n</code></pre> <p>Full Example:</p> <pre><code># Create 10 vouchers: 2 hours, 500MB quota, 5/10 Mbps limits\n./ui lo vouchers create -c 10 -d 120 -q 500 --up 5000 --down 10000 -n \"Event\"\n</code></pre>"},{"location":"commands/local/#delete-voucher","title":"Delete Voucher","text":"<pre><code>./ui lo vouchers delete 12345-67890\n./ui lo vouchers delete 12345-67890 -y     # Skip confirmation\n</code></pre>"},{"location":"commands/local/#dpi-deep-packet-inspection","title":"DPI (Deep Packet Inspection)","text":"<p>View traffic analytics.</p> <p>DPI must be enabled</p> <p>DPI statistics require DPI to be enabled in your controller settings.</p>"},{"location":"commands/local/#site-statistics","title":"Site Statistics","text":"<pre><code>./ui lo dpi stats              # Top applications\n./ui lo dpi stats -l 20        # Top 20\n./ui lo dpi stats -v           # Verbose\n</code></pre>"},{"location":"commands/local/#client-statistics","title":"Client Statistics","text":"<pre><code>./ui lo dpi client my-MacBook\n./ui lo dpi client AA:BB:CC:DD:EE:FF\n</code></pre>"},{"location":"commands/local/#statistics","title":"Statistics","text":"<p>View traffic statistics.</p>"},{"location":"commands/local/#daily-stats","title":"Daily Stats","text":"<pre><code>./ui lo stats daily            # Last 30 days\n./ui lo stats daily --days 7   # Last 7 days\n./ui lo stats daily -o csv     # CSV export\n</code></pre>"},{"location":"commands/local/#hourly-stats","title":"Hourly Stats","text":"<pre><code>./ui lo stats hourly           # Last 24 hours\n./ui lo stats hourly --hours 48\n</code></pre>"},{"location":"commands/local/#events","title":"Events","text":"<p>View recent events.</p> <pre><code>./ui lo events list            # Recent events\n./ui lo events list -l 50      # Last 50 events\n./ui lo events list -v         # Verbose\n</code></pre>"},{"location":"commands/local/#config","title":"Config","text":"<p>Export running configuration.</p>"},{"location":"commands/local/#show-config","title":"Show Config","text":"<pre><code>./ui lo config show            # All sections\n./ui lo config show -o yaml    # YAML export\n./ui lo config show -o json    # JSON export\n./ui lo config show -v         # Include IDs\n./ui lo config show --show-secrets  # Include passwords\n</code></pre>"},{"location":"commands/local/#specific-sections","title":"Specific Sections","text":"<pre><code>./ui lo config show -s networks    # Networks and VLANs\n./ui lo config show -s wireless    # SSIDs and WiFi settings\n./ui lo config show -s firewall    # Firewall rules\n./ui lo config show -s devices     # Device inventory\n./ui lo config show -s portfwd     # Port forwarding\n./ui lo config show -s dhcp        # DHCP reservations\n./ui lo config show -s routing     # Static routes\n</code></pre>"},{"location":"commands/local/#backup-to-file","title":"Backup to File","text":"<pre><code>./ui lo config show -o yaml &gt; backup-$(date +%Y%m%d).yaml\n</code></pre>"},{"location":"commands/mcp/","title":"Claude Desktop Integration","text":"<p>Control your UniFi network using natural language through Claude Desktop.</p>"},{"location":"commands/mcp/#overview","title":"Overview","text":"<p>UI-CLI includes an MCP (Model Context Protocol) server that enables Claude Desktop to manage your UniFi infrastructure. Ask questions like:</p> <ul> <li>\"How many devices are connected to my network?\"</li> <li>\"What's my network health status?\"</li> <li>\"Block the kids iPad\"</li> <li>\"Restart the garage access point\"</li> </ul>"},{"location":"commands/mcp/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Claude Desktop \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502 MCP Protocol (stdio)\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   MCP Server    \u2502  \u2190 21 AI-optimized tools\n\u2502   (ui_mcp)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502 subprocess\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    UI CLI       \u2502  \u2190 All business logic\n\u2502   (ui_cli)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"commands/mcp/#installation","title":"Installation","text":""},{"location":"commands/mcp/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11+ with conda environment <code>ui-cli</code></li> <li>Claude Desktop installed</li> <li>UniFi credentials configured in <code>.env</code></li> </ul>"},{"location":"commands/mcp/#setup","title":"Setup","text":"<pre><code># Install MCP server to Claude Desktop\n./ui mcp install\n\n# Verify installation\n./ui mcp check\n\n# View current config\n./ui mcp show\n</code></pre> <p>After installation, restart Claude Desktop to load the new tools.</p>"},{"location":"commands/mcp/#available-tools","title":"Available Tools","text":""},{"location":"commands/mcp/#status-health","title":"Status &amp; Health","text":"Tool Description Example Prompt <code>network_status</code> Check API connectivity \"Is my network API working?\" <code>network_health</code> Site health summary \"What's my network health?\" <code>internet_speed</code> Last speed test result \"What's my internet speed?\" <code>run_speedtest</code> Run new speed test \"Run a speed test\" <code>isp_performance</code> ISP metrics over time \"How's my ISP been performing?\""},{"location":"commands/mcp/#counts-lists","title":"Counts &amp; Lists","text":"Tool Description Example Prompt <code>client_count</code> Count clients by category \"How many devices are connected?\" <code>device_list</code> List UniFi devices \"What UniFi devices do I have?\" <code>network_list</code> List networks/VLANs \"Show my networks\""},{"location":"commands/mcp/#lookups","title":"Lookups","text":"Tool Description Example Prompt <code>find_client</code> Find client by name/MAC \"Find my iPhone\" <code>find_device</code> Find device by name/MAC/IP \"Show the living room AP\" <code>client_status</code> Check if client is online/blocked \"Is the TV online?\""},{"location":"commands/mcp/#actions","title":"Actions","text":"Tool Description Example Prompt <code>block_client</code> Block from network \"Block the kids iPad\" <code>unblock_client</code> Restore access \"Unblock the kids iPad\" <code>kick_client</code> Force disconnect \"Disconnect my laptop\" <code>restart_device</code> Reboot device \"Restart the garage AP\" <code>create_voucher</code> Create guest WiFi code \"Create a guest WiFi voucher\""},{"location":"commands/mcp/#groups","title":"Groups","text":"Tool Description Example Prompt <code>list_groups</code> List all client groups \"What groups do I have?\" <code>get_group</code> Get group details \"Show the kids devices group\" <code>block_group</code> Block all clients in group \"Block all kids devices\" <code>unblock_group</code> Unblock all clients in group \"Unblock the kids devices\" <code>group_status</code> Live status of group members \"Are the kids devices online?\""},{"location":"commands/mcp/#example-conversations","title":"Example Conversations","text":""},{"location":"commands/mcp/#checking-network-status","title":"Checking Network Status","text":"<p>You: How many devices are connected to my network?</p> <p>Claude: You have 87 devices connected: - 17 wired clients - 70 wireless clients - 52 on WiFi 6, 18 on WiFi 5</p>"},{"location":"commands/mcp/#managing-clients","title":"Managing Clients","text":"<p>You: Block the kids iPad</p> <p>Claude: I'll block that device. Looking for \"kids iPad\"...</p> <p>Found: Kids-iPad (MAC: aacc:dd:ee:ff)</p> <p>Done! Kids-iPad has been blocked from the network.</p>"},{"location":"commands/mcp/#device-management","title":"Device Management","text":"<p>You: Restart the garage access point</p> <p>Claude: I'll restart that device. Looking for \"garage\"...</p> <p>Found: Garage-AP (U6-Lite)</p> <p>Restart initiated. The access point will be back online in about 2 minutes.</p>"},{"location":"commands/mcp/#troubleshooting","title":"Troubleshooting","text":""},{"location":"commands/mcp/#tools-not-appearing","title":"Tools Not Appearing","text":"<ol> <li>Restart Claude Desktop after running <code>./ui mcp install</code></li> <li>Check that <code>.env</code> file exists with credentials</li> <li>Run <code>./ui mcp check</code> to verify setup</li> </ol>"},{"location":"commands/mcp/#conda-environment-not-found","title":"\"Conda environment not found\"","text":"<p>Ensure the conda environment is activated when installing:</p> <pre><code>conda activate ui-cli\n./ui mcp install\n</code></pre>"},{"location":"commands/mcp/#timeout-errors","title":"Timeout Errors","text":"<p>Some operations like speed tests take longer. Claude will wait up to 60 seconds for these operations.</p>"},{"location":"commands/mcp/#view-logs","title":"View Logs","text":"<p>Check MCP server logs in Claude Desktop:</p> <ul> <li>macOS: <code>~/Library/Logs/Claude/mcp*.log</code></li> </ul>"},{"location":"commands/mcp/#configuration","title":"Configuration","text":"<p>The installer adds this to Claude Desktop's config (<code>~/Library/Application Support/Claude/claude_desktop_config.json</code>):</p> <pre><code>{\n  \"mcpServers\": {\n    \"ui-cli\": {\n      \"command\": \"/path/to/ui-cmd/scripts/mcp-server.sh\",\n      \"args\": [],\n      \"env\": {\n        \"PYTHON_PATH\": \"/path/to/conda/envs/ui-cli/bin/python\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"commands/mcp/#security-notes","title":"Security Notes","text":"<ul> <li>Credentials are stored in <code>.env</code> file (not in Claude Desktop config)</li> <li>Claude will ask for confirmation before performing destructive actions</li> <li>All operations are logged</li> </ul>"},{"location":"commands/mcp/#version","title":"Version","text":"<p>Current MCP Server version: 0.3.0 (Tools Layer Architecture)</p>"},{"location":"plans/mcp-server-v2/","title":"MCP Server v2 - Tools Layer Architecture","text":""},{"location":"plans/mcp-server-v2/#overview","title":"Overview","text":"<p>Rewrite the MCP server as a thin tools layer that calls the UI CLI via subprocess. This ensures consistent behavior, single source of truth, and easier debugging.</p>"},{"location":"plans/mcp-server-v2/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Claude Desktop \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502 MCP Protocol (stdio)\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Tools Layer   \u2502  \u2190 15 well-defined tools\n\u2502   (ui_mcp/v2/)  \u2502  \u2190 Friendly names, chat-optimized\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502 subprocess.run(\"./ui ...\")\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    UI CLI       \u2502  \u2190 All logic, formatting, error handling\n\u2502   (ui_cli/)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"plans/mcp-server-v2/#design-principles","title":"Design Principles","text":"<ol> <li>CLI is the source of truth - MCP tools just call CLI commands</li> <li>Friendly tool names - <code>network_health</code> not <code>unifi_lo_health</code></li> <li>Chat-optimized output - Use <code>--json</code> and format for readability</li> <li>Lightweight responses - Prefer counts/summaries over full lists</li> <li>Safe by default - Read-only tools, actions clearly named</li> </ol>"},{"location":"plans/mcp-server-v2/#tools-specification","title":"Tools Specification","text":""},{"location":"plans/mcp-server-v2/#category-1-status-health-read-only","title":"Category 1: Status &amp; Health (Read-only)","text":"Tool CLI Command Description <code>network_status</code> <code>./ui status</code> Check API connectivity <code>network_health</code> <code>./ui lo health -o json</code> Site health summary <code>internet_speed</code> <code>./ui speedtest -o json</code> Last speed test result <code>run_speedtest</code> <code>./ui speedtest -r -o json</code> Run new speed test <code>isp_performance</code> <code>./ui isp metrics -o json</code> ISP metrics (7 days)"},{"location":"plans/mcp-server-v2/#category-2-counts-summaries-read-only","title":"Category 2: Counts &amp; Summaries (Read-only)","text":"Tool CLI Command Description <code>client_count</code> <code>./ui lo clients count -o json</code> Device counts by type <code>device_list</code> <code>./ui lo devices list -o json</code> UniFi infrastructure <code>network_list</code> <code>./ui lo networks -o json</code> Networks and VLANs"},{"location":"plans/mcp-server-v2/#category-3-lookups-read-only","title":"Category 3: Lookups (Read-only)","text":"Tool CLI Command Description <code>find_client</code> <code>./ui lo clients get &lt;name&gt; -o json</code> Find device by name <code>find_device</code> <code>./ui lo devices get &lt;name&gt; -o json</code> Find UniFi device <code>client_status</code> <code>./ui lo clients status &lt;name&gt; -o json</code> Check if blocked"},{"location":"plans/mcp-server-v2/#category-4-actions-mutating","title":"Category 4: Actions (Mutating)","text":"Tool CLI Command Description <code>block_client</code> <code>./ui lo clients block &lt;name&gt;</code> Block from network <code>unblock_client</code> <code>./ui lo clients unblock &lt;name&gt;</code> Restore access <code>kick_client</code> <code>./ui lo clients kick &lt;name&gt;</code> Force disconnect <code>restart_device</code> <code>./ui lo devices restart &lt;name&gt;</code> Reboot device <code>create_voucher</code> <code>./ui lo vouchers create</code> Guest WiFi code"},{"location":"plans/mcp-server-v2/#implementation-plan","title":"Implementation Plan","text":""},{"location":"plans/mcp-server-v2/#phase-1-foundation","title":"Phase 1: Foundation","text":"<ul> <li>[ ] Create <code>src/ui_mcp/v2/</code> directory structure</li> <li>[ ] Implement <code>cli_runner.py</code> - subprocess wrapper with timeout, error handling</li> <li>[ ] Implement <code>server.py</code> - FastMCP server with tool registration</li> <li>[ ] Add <code>--json</code> output to CLI commands that don't have it</li> </ul>"},{"location":"plans/mcp-server-v2/#phase-2-read-only-tools-8-tools","title":"Phase 2: Read-only Tools (8 tools)","text":"<ul> <li>[ ] <code>network_status</code></li> <li>[ ] <code>network_health</code></li> <li>[ ] <code>internet_speed</code></li> <li>[ ] <code>isp_performance</code></li> <li>[ ] <code>client_count</code></li> <li>[ ] <code>device_list</code></li> <li>[ ] <code>network_list</code></li> <li>[ ] <code>find_client</code></li> </ul>"},{"location":"plans/mcp-server-v2/#phase-3-lookup-action-tools-7-tools","title":"Phase 3: Lookup &amp; Action Tools (7 tools)","text":"<ul> <li>[ ] <code>find_device</code></li> <li>[ ] <code>client_status</code></li> <li>[ ] <code>block_client</code></li> <li>[ ] <code>unblock_client</code></li> <li>[ ] <code>kick_client</code></li> <li>[ ] <code>restart_device</code></li> <li>[ ] <code>create_voucher</code></li> </ul>"},{"location":"plans/mcp-server-v2/#phase-4-polish","title":"Phase 4: Polish","text":"<ul> <li>[ ] Update <code>./ui mcp install</code> to use v2</li> <li>[ ] Remove old MCP server code</li> <li>[ ] Update documentation</li> <li>[ ] Test all tools in Claude Desktop</li> </ul>"},{"location":"plans/mcp-server-v2/#file-structure","title":"File Structure","text":"<pre><code>src/ui_mcp/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 __main__.py          # Entry point (updated for v2)\n\u251c\u2500\u2500 v2/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 server.py        # FastMCP server + tool definitions\n\u2502   \u251c\u2500\u2500 cli_runner.py    # Subprocess wrapper\n\u2502   \u2514\u2500\u2500 tools/\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u251c\u2500\u2500 status.py    # network_status, network_health, internet_speed\n\u2502       \u251c\u2500\u2500 clients.py   # client_count, find_client, block/unblock/kick\n\u2502       \u251c\u2500\u2500 devices.py   # device_list, find_device, restart_device\n\u2502       \u2514\u2500\u2500 network.py   # network_list, isp_performance, create_voucher\n</code></pre>"},{"location":"plans/mcp-server-v2/#cli-runner-design","title":"CLI Runner Design","text":"<pre><code># cli_runner.py\nimport subprocess\nimport json\nfrom pathlib import Path\n\nPROJECT_ROOT = Path(__file__).parent.parent.parent.parent\n\ndef run_cli(args: list[str], timeout: int = 30) -&gt; dict:\n    \"\"\"Run UI CLI command and return parsed JSON output.\n\n    Args:\n        args: Command arguments (e.g., [\"lo\", \"health\", \"-o\", \"json\"])\n        timeout: Command timeout in seconds\n\n    Returns:\n        Parsed JSON output or error dict\n    \"\"\"\n    cmd = [\"./ui\"] + args\n\n    try:\n        result = subprocess.run(\n            cmd,\n            cwd=PROJECT_ROOT,\n            capture_output=True,\n            text=True,\n            timeout=timeout,\n        )\n\n        if result.returncode != 0:\n            return {\n                \"error\": True,\n                \"message\": result.stderr.strip() or \"Command failed\",\n                \"exit_code\": result.returncode,\n            }\n\n        # Try to parse as JSON\n        try:\n            return json.loads(result.stdout)\n        except json.JSONDecodeError:\n            # Return raw output if not JSON\n            return {\"output\": result.stdout.strip()}\n\n    except subprocess.TimeoutExpired:\n        return {\"error\": True, \"message\": f\"Command timed out after {timeout}s\"}\n    except Exception as e:\n        return {\"error\": True, \"message\": str(e)}\n</code></pre>"},{"location":"plans/mcp-server-v2/#tool-definition-pattern","title":"Tool Definition Pattern","text":"<pre><code># tools/status.py\nfrom ..cli_runner import run_cli\n\nasync def network_health() -&gt; str:\n    \"\"\"Get network health status.\n\n    Returns health status for WAN, LAN, WLAN subsystems.\n    \"\"\"\n    result = run_cli([\"lo\", \"health\", \"-o\", \"json\"])\n\n    if result.get(\"error\"):\n        return json.dumps(result)\n\n    # Format for chat\n    summary = format_health_summary(result)\n    return json.dumps({\n        \"summary\": summary,\n        \"details\": result,\n    })\n</code></pre>"},{"location":"plans/mcp-server-v2/#migration-strategy","title":"Migration Strategy","text":"<ol> <li>Build v2 in parallel (<code>ui_mcp/v2/</code>)</li> <li>Test thoroughly before switching</li> <li>Update <code>__main__.py</code> to use v2</li> <li>Keep v1 code until v2 is stable</li> <li>Remove v1 after confirmation</li> </ol>"},{"location":"plans/mcp-server-v2/#success-criteria","title":"Success Criteria","text":"<ul> <li>[ ] All 15 tools work in Claude Desktop</li> <li>[ ] Response times &lt; 5 seconds</li> <li>[ ] Output displays correctly (no \"no output\" issues)</li> <li>[ ] Error messages are helpful</li> <li>[ ] Actions (block, restart) work reliably</li> </ul>"}]}